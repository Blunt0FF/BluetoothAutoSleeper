# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ BluetoothAutoSleeper v2.0

## üÜï –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. **‚úÖ –£–º–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 5 —Å–µ–∫—É–Ω–¥** - Bluetooth –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–æ–Ω –¥–ª–∏—Ç—Å—è > 5 —Å–µ–∫
2. **‚úÖ –£–ª—É—á—à–µ–Ω–Ω—ã–π Bluetooth –∫–æ–Ω—Ç—Ä–æ–ª—å** - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ blueutil + –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
3. **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω GUI –ª–æ–≥–æ–≤** - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ Close + –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —á—Ç–µ–Ω–∏—è –ª–æ–≥–æ–≤

## üß™ –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞
```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
cd BluetoothAutoSleeper

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å Bluetooth –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
./test_daemon.sh bluetooth-status

# –ï—Å–ª–∏ blueutil –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
./test_daemon.sh install-blueutil
```

### 2. –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω–∞
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –ª–æ–≥–∏ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –¥–µ–º–æ–Ω
./test_daemon.sh clear
./test_daemon.sh start

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –¥–µ–º–æ–Ω –∑–∞–ø—É—â–µ–Ω
./test_daemon.sh status
./test_daemon.sh logs
```

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ GUI
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ GUI
open BluetoothAutoSleeper.app

# –í GUI:
# - –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –¥–µ–º–æ–Ω –∑–∞–ø—É—â–µ–Ω (–∑–µ–ª–µ–Ω—ã–π gear icon)
# - –ù–∞–∂–º–∏—Ç–µ "View Logs" - –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è –ª–æ–≥–∏
# - –í –æ–∫–Ω–µ –ª–æ–≥–æ–≤ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–Ω–æ–ø–∫–∞ "Close"
# - Escape —Ç–∞–∫–∂–µ –¥–æ–ª–∂–µ–Ω –∑–∞–∫—Ä—ã–≤–∞—Ç—å –æ–∫–Ω–æ
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —É–º–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏

#### –¢–µ—Å—Ç 1: –ë—ã—Å—Ç—Ä–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ (< 5 —Å–µ–∫)
1. **–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Bluetooth –≤–∫–ª—é—á–µ–Ω –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã**
   ```bash
   ./test_daemon.sh bluetooth-status
   ```

2. **–ó–∞–∫—Ä–æ–π—Ç–µ MacBook –∫—Ä—ã—à–∫–æ–π –Ω–∞ 2-3 —Å–µ–∫—É–Ω–¥—ã, –∑–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π—Ç–µ**

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**
   ```bash
   ./test_daemon.sh logs
   ```
   
   **–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**
   ```
   üí§ System will sleep - starting 5.0 second countdown...
   ‚è≥ Bluetooth will be disabled in 5.0 seconds unless system wakes up...
   ‚òÄÔ∏è System did wake - checking if we need to cancel sleep timer...
   ‚úÖ Sleep timer cancelled - Bluetooth stays connected!
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ—Å—Ç–∞–ª–∏—Å—å –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º–∏**
   ```bash
   ./test_daemon.sh bluetooth-status
   ```

#### –¢–µ—Å—Ç 2: –î–ª–∏—Ç–µ–ª—å–Ω—ã–π —Å–æ–Ω (> 5 —Å–µ–∫)
1. **–ó–∞–∫—Ä–æ–π—Ç–µ MacBook –∫—Ä—ã—à–∫–æ–π –Ω–∞ 8-10 —Å–µ–∫—É–Ω–¥**

2. **–û—Ç–∫—Ä–æ–π—Ç–µ MacBook**

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**
   ```bash
   ./test_daemon.sh logs
   ```
   
   **–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**
   ```
   üí§ System will sleep - starting 5.0 second countdown...
   ‚è≥ Bluetooth will be disabled in 5.0 seconds unless system wakes up...
   ‚è∞ Sleep delay expired - disabling Bluetooth
   üîÑ Attempting to disable Bluetooth...
   üîß Executing: blueutil -p 0
   ‚úÖ Command succeeded
   ‚úÖ Bluetooth disabled via blueutil
   üîµ Bluetooth disabled after 5.0 second delay
   ‚òÄÔ∏è System did wake - checking if we need to cancel sleep timer...
   ‚ö†Ô∏è No active sleep timer found
   üîÑ Attempting to enable Bluetooth...
   üîß Executing: blueutil -p 1
   ‚úÖ Command succeeded
   ‚úÖ Bluetooth enabled via blueutil
   üîµ Bluetooth enabled after wake
   ```

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Bluetooth —Å–Ω–æ–≤–∞ –≤–∫–ª—é—á–µ–Ω**
   ```bash
   ./test_daemon.sh bluetooth-status
   ```

### 5. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

#### –ï—Å–ª–∏ Bluetooth –Ω–µ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
./test_daemon.sh logs | grep -E "(error|failed|‚ùå)"

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä—É—á–Ω—É—é
blueutil -p 0  # –æ—Ç–∫–ª—é—á–∏—Ç—å
sleep 2
blueutil -p 1  # –≤–∫–ª—é—á–∏—Ç—å

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
ls -la /tmp/bluetooth_daemon.*
```

#### –ï—Å–ª–∏ –ª–æ–≥–∏ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ GUI:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –ª–æ–≥–æ–≤
ls -la /tmp/bluetooth_daemon.log
cat /tmp/bluetooth_daemon.log

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ GUI –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
./BluetoothAutoSleeper.app/Contents/MacOS/BluetoothAutoSleeper
```

## üéØ –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–ª—É—á–∞–π–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ MacBook
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –°–ª—É—à–∞–µ—Ç –º—É–∑—ã–∫—É –≤ –Ω–∞—É—à–Ω–∏–∫–∞—Ö
- **–î–µ–π—Å—Ç–≤–∏–µ**: –°–ª—É—á–∞–π–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç MacBook –Ω–∞ 2 —Å–µ–∫—É–Ω–¥—ã
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ Bluetooth –æ—Å—Ç–∞–µ—Ç—Å—è –≤–∫–ª—é—á–µ–Ω–Ω—ã–º, –º—É–∑—ã–∫–∞ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –£–º—ã—à–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ —Å–æ–Ω
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –ò–¥–µ—Ç –æ–±–µ–¥–∞—Ç—å, –∑–∞–∫—Ä—ã–≤–∞–µ—Ç MacBook
- **–î–µ–π—Å—Ç–≤–∏–µ**: MacBook –≤ —Å–Ω–µ > 5 —Å–µ–∫—É–Ω–¥
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ Bluetooth –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è, —ç–∫–æ–Ω–æ–º–∏—Ç—Å—è –±–∞—Ç–∞—Ä–µ—è

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –í–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ –∫ —Ä–∞–±–æ—Ç–µ
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±–µ–¥–∞
- **–î–µ–π—Å—Ç–≤–∏–µ**: –û—Ç–∫—Ä—ã–≤–∞–µ—Ç MacBook
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ Bluetooth –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç—Å—è, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
./test_daemon.sh start              # –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ–Ω
./test_daemon.sh stop               # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–µ–º–æ–Ω  
./test_daemon.sh status             # –°—Ç–∞—Ç—É—Å –¥–µ–º–æ–Ω–∞
./test_daemon.sh logs               # –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏
./test_daemon.sh clear              # –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏
./test_daemon.sh bluetooth-status   # –°—Ç–∞—Ç—É—Å Bluetooth
./test_daemon.sh install-blueutil   # –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å blueutil
./test_daemon.sh test               # –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç
```

## üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- macOS 11.0+
- Homebrew (–¥–ª—è blueutil)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è Accessibility (–¥–ª—è AppleScript)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏—è AppleEvents 